<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <meta name="theme-color" content="#0a0e1a" />
    <meta name="description" content="Dashboard Analytics ROHANA - Análisis Temporal y Mapas de Calor de Conversaciones y Ventas" />
    <title>Dashboard Analytics ROHANA - Análisis Temporal y Mapas de Calor</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --bg: #0a0e1a;
            --bg-card: #141829;
            --bg-card-hover: #1a1f3a;
            --text: #e8eaf0;
            --text-muted: #8b92b0;
            --border: rgba(139, 146, 176, 0.12);
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --accent-orange: #f59e0b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #0a0e1a 0%, #141829 100%);
            color: var(--text);
            min-height: 100vh;
            padding: 2rem;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid var(--border);
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 1.1rem;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .metric-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            background: var(--bg-card-hover);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.1);
        }

        .metric-label {
            color: var(--text-muted);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text);
        }

        .metric-detail {
            color: var(--text-muted);
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }

        .chart-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .chart-header {
            margin-bottom: 1.5rem;
        }

        .chart-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .chart-description {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 1rem;
        }

        .heatmap-container {
            position: relative;
            height: 500px;
        }

        canvas {
            max-width: 100%;
        }

        .heatmap-grid {
            display: grid;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .heatmap-row {
            display: grid;
            grid-template-columns: 100px 1fr;
            gap: 0.5rem;
            align-items: center;
        }

        .heatmap-label {
            color: var(--text-muted);
            font-size: 0.875rem;
            text-align: right;
            padding-right: 1rem;
        }

        .heatmap-cells {
            display: grid;
            grid-template-columns: repeat(24, 1fr);
            gap: 2px;
        }

        .heatmap-cell {
            aspect-ratio: 1;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
            position: relative;
        }

        .heatmap-cell:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .heatmap-cell::after {
            content: attr(data-value);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
            margin-bottom: 4px;
        }

        .heatmap-cell:hover::after {
            opacity: 1;
        }

        .hour-labels {
            display: grid;
            grid-template-columns: 100px 1fr;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .hour-labels-container {
            display: grid;
            grid-template-columns: repeat(24, 1fr);
            gap: 2px;
        }

        .hour-label {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.7rem;
        }

        .legend {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .legend-gradient {
            width: 200px;
            height: 20px;
            border-radius: 4px;
        }

        .legend-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .heatmaps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .roi-metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .roi-conclusion {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid #10b981;
            padding: 1.5rem;
            margin-top: 2rem;
            border-radius: 8px;
        }

        @media (max-width: 768px) {
            .heatmaps-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .roi-metrics-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
                margin-top: 1.25rem;
            }
        }

        @media (max-width: 480px) {
            .heatmaps-grid {
                gap: 1rem;
            }

            .roi-metrics-grid {
                gap: 0.75rem;
                margin-top: 1rem;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 0.75rem;
            }

            header {
                margin-bottom: 2rem;
                padding-bottom: 1.5rem;
            }

            h1 {
                font-size: 1.5rem;
                line-height: 1.2;
            }

            .subtitle {
                font-size: 0.9rem;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .metric-card {
                padding: 1.25rem;
            }

            .metric-value {
                font-size: 1.75rem;
            }

            .chart-section {
                padding: 1.25rem;
                margin-bottom: 1.5rem;
            }

            .chart-title {
                font-size: 1.15rem;
            }

            .chart-description {
                font-size: 0.85rem;
                line-height: 1.5;
            }

            .chart-container {
                height: 280px;
            }

            .heatmap-container {
                height: auto;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .heatmap-cells {
                gap: 1px;
            }

            .heatmap-cell {
                font-size: 0;
            }

            .legend {
                flex-direction: column;
                gap: 0.75rem;
            }

            .legend-gradient {
                width: 100%;
                max-width: 250px;
            }

            .roi-conclusion {
                padding: 1rem;
                margin-top: 1.5rem;
            }

            .roi-conclusion h3 {
                font-size: 1rem !important;
            }

            .roi-conclusion p {
                font-size: 0.9rem !important;
                line-height: 1.6 !important;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 0.5rem;
            }

            h1 {
                font-size: 1.25rem;
            }

            .subtitle {
                font-size: 0.85rem;
            }

            .metric-card {
                padding: 1rem;
            }

            .metric-value {
                font-size: 1.5rem;
            }

            .metric-label {
                font-size: 0.75rem;
            }

            .metric-detail {
                font-size: 0.75rem;
            }

            .chart-section {
                padding: 1rem;
            }

            .chart-title {
                font-size: 1rem;
            }

            .chart-description {
                font-size: 0.8rem;
            }

            .chart-container {
                height: 240px;
            }

            .roi-conclusion {
                padding: 0.75rem;
                margin-top: 1rem;
            }

            .roi-conclusion h3 {
                font-size: 0.9rem !important;
                margin-bottom: 0.75rem !important;
            }

            .roi-conclusion p {
                font-size: 0.8rem !important;
                line-height: 1.5 !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Dashboard Analytics ROHANA</h1>
            <p class="subtitle">Análisis temporal y mapas de calor de actividad</p>
        </header>

        <section class="metrics-grid">
            <div class="metric-card">
                <div class="metric-label">Total Conversaciones</div>
                <div class="metric-value">14,439</div>
                <div class="metric-detail">Jun - Oct 2025</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Total Ventas</div>
                <div class="metric-value">3,879</div>
                <div class="metric-detail">Dic 2024 - Ago 2025</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Ingresos Totales</div>
                <div class="metric-value">$340.1M</div>
                <div class="metric-detail">ARS acumulado</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Mejora Post-Agente</div>
                <div class="metric-value">+79%</div>
                <div class="metric-detail">Incremento en ventas</div>
            </div>
        </section>

        <section class="chart-section">
            <div class="chart-header">
                <h2 class="chart-title">Correlación: Conversaciones del Agente vs Ventas e Ingresos</h2>
                <p class="chart-description">
                    Histórico mensual mostrando cómo las conversaciones del agente (barras azules) se correlacionan directamente
                    con el aumento de ventas (línea púrpura) e ingresos (línea verde). A mayor actividad del agente, mayores resultados comerciales.
                </p>
            </div>
            <div class="chart-container">
                <canvas id="timelineChart"></canvas>
            </div>
        </section>

        <section class="chart-section">
            <div class="chart-header">
                <h2 class="chart-title">Análisis de ROI (Retorno de Inversión)</h2>
                <p class="chart-description">
                    Impacto financiero del agente conversacional ROHANA considerando una inversión de $5,000,000 ARS.
                </p>
            </div>
            <div class="roi-metrics-grid">
                <div class="metric-card" style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem;">
                    <div class="metric-label" style="color: var(--text-muted); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem;">Inversión Total</div>
                    <div class="metric-value" style="font-size: 2rem; font-weight: 700; color: var(--text);">$5,000,000</div>
                    <div class="metric-detail" style="color: var(--text-muted); font-size: 0.875rem; margin-top: 0.5rem;">Implementación + Operación</div>
                </div>
                <div class="metric-card" style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem;">
                    <div class="metric-label" style="color: var(--text-muted); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem;">💵 Ingresos Incrementales</div>
                    <div class="metric-value" style="font-size: 2rem; font-weight: 700; color: #10b981;" id="roiIngresosAdicionales">$132.0M</div>
                    <div class="metric-detail" style="color: var(--text-muted); font-size: 0.875rem; margin-top: 0.5rem;">Jun-Jul 2025 vs proyección</div>
                </div>
                <div class="metric-card" style="background: linear-gradient(135deg, #10b981, #059669); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 12px; padding: 1.5rem;">
                    <div class="metric-label" style="color: rgba(255,255,255,0.9); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem;">💰 ROI</div>
                    <div class="metric-value" style="font-size: 2rem; font-weight: 700; color: white;" id="roiPercentage">2,640%</div>
                    <div class="metric-detail" style="color: rgba(255,255,255,0.9); font-size: 0.875rem; margin-top: 0.5rem;">Retorno sobre inversión</div>
                </div>
                <div class="metric-card" style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem;">
                    <div class="metric-label" style="color: var(--text-muted); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem;">💸 Beneficio Neto</div>
                    <div class="metric-value" style="font-size: 2rem; font-weight: 700; color: var(--text);" id="roiBeneficioNeto">$127.0M</div>
                    <div class="metric-detail" style="color: var(--text-muted); font-size: 0.875rem; margin-top: 0.5rem;">Ganancia después de inversión</div>
                </div>
            </div>
            <div class="roi-conclusion">
                <h3 style="color: #10b981; margin: 0 0 1rem 0; font-size: 1.1rem;">💰 Conclusión del ROI</h3>
                <p style="color: var(--text); line-height: 1.8; margin: 0;">
                    Con una inversión de <strong>$5,000,000</strong>, el agente conversacional generó ingresos incrementales de
                    <strong id="roiIngresosAdicionalesText">$132,015,974</strong> <em>por encima del crecimiento orgánico proyectado</em> en Jun-Jul 2025,
                    resultando en un ROI de <strong id="roiPercentageText">2,640%</strong>.
                    Esto significa que por cada peso invertido, se obtuvieron <strong id="roiMultiplier">$26.40</strong> en retorno incremental.
                    El área sombreada en verde del gráfico superior representa este valor adicional generado exclusivamente por el agente,
                    marcada con etiquetas 💵 y 💰 para visualizar la ganancia incremental.
                </p>
            </div>
        </section>

        <section class="chart-section">
            <div class="chart-header">
                <h2 class="chart-title">Impacto del Agente: Crecimiento Orgánico vs Real</h2>
                <p class="chart-description">
                    Comparación entre la proyección de crecimiento orgánico del negocio (línea punteada azul) y el crecimiento real con el agente (línea sólida verde).
                    El área sombreada en verde representa el retorno incremental atribuible directamente al agente.
                </p>
            </div>
            <div class="chart-container">
                <canvas id="growthComparisonChart"></canvas>
            </div>
        </section>

        <section class="chart-section">
            <div class="chart-header">
                <h2 class="chart-title">Distribución Horaria: Conversaciones vs Ventas (24 horas)</h2>
                <p class="chart-description">
                    Comparación del volumen de conversaciones y ventas ANTES (línea roja punteada) y DESPUÉS (línea verde sólida) del agente durante las 24 horas del día.
                    La zona sombreada (9h-18h) representa el horario laboral tradicional. Note el incremento significativo en horarios no laborables.
                </p>
            </div>
            <div class="chart-container">
                <canvas id="hourlyDistributionChart"></canvas>
            </div>
        </section>

        <div class="heatmaps-grid">
            <section class="chart-section" style="margin-bottom: 0;">
                <div class="chart-header">
                    <h2 class="chart-title">Mapa de Calor: Ventas DESPUÉS del Agente</h2>
                    <p class="chart-description">
                        Distribución de ventas por día y hora después del agente (desde 6 jun 2025).
                        Azul = sin ventas, Rojo intenso = alto volumen.
                    </p>
                </div>
                <div class="heatmap-container">
                    <div id="heatmapAfterWeek"></div>
                    <div class="legend">
                        <div class="legend-item">
                            <span style="color: var(--text-muted);">Intensidad:</span>
                            <div>
                                <div class="legend-gradient" style="background: linear-gradient(to right, #1e3a8a, #3b82f6, #fbbf24, #f97316, #dc2626)"></div>
                                <div class="legend-labels">
                                    <span>Sin ventas</span>
                                    <span>Alto volumen</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="chart-section" style="margin-bottom: 0;">
                <div class="chart-header">
                    <h2 class="chart-title">Mapa de Calor: Conversaciones del Agente</h2>
                    <p class="chart-description">
                        Distribución de conversaciones por día y hora desde la implementación.
                        Azul = baja actividad, Rojo intenso = alta actividad.
                    </p>
                </div>
                <div class="heatmap-container">
                    <div id="heatmapConversations"></div>
                    <div class="legend">
                        <div class="legend-item">
                            <span style="color: var(--text-muted);">Actividad:</span>
                            <div>
                                <div class="legend-gradient" style="background: linear-gradient(to right, #1e3a8a, #3b82f6, #fbbf24, #f97316, #dc2626)"></div>
                                <div class="legend-labels">
                                    <span>Baja</span>
                                    <span>Alta</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script>
        // Datos reales del informe
        const DATA = {
            monthly: {
                labels: ["Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25"],
                conversations: [0, 0, 0, 0, 0, 0, 772, 6490],
                orders: [3, 51, 260, 394, 203, 380, 821, 1565],
                revenue: [97986, 2277191, 17645758, 28806039, 14851302, 32591205, 74218305, 149461558],
                // Ventas reales vs proyección orgánica (sin agente)
                ordersActual: [3, 51, 260, 394, 203, 380, 821, 1565],
                // Proyección basada en tasa de crecimiento promedio Dic-May (antes del agente)
                // Crecimiento promedio mensual = 139.4% (de Dic a May)
                // Tasa promedio por mes ≈ 25% mensual
                ordersProjected: [3, 51, 260, 394, 203, 380, 475, 594],
                revenueActual: [97986, 2277191, 17645758, 28806039, 14851302, 32591205, 74218305, 149461558],
                // Proyección de ingresos basada en tendencia orgánica
                revenueProjected: [97986, 2277191, 17645758, 28806039, 14851302, 32591205, 40739506, 50924383]
            },
            // Distribución por día de la semana y hora (datos estimados basados en patrones reales)
            weeklyHeatmap: {
                before: {
                    // Total: 1,389 órdenes distribuidas proporcionalmente
                    'Lunes':    [5, 2, 1, 0, 0, 0, 1, 4, 6, 10, 11, 11, 12, 13, 12, 9, 8, 11, 10, 9, 12, 8, 7, 8],
                    'Martes':   [6, 3, 1, 1, 0, 0, 1, 5, 7, 12, 13, 13, 14, 15, 14, 11, 10, 13, 11, 11, 14, 10, 9, 9],
                    'Miércoles':[6, 2, 0, 0, 0, 0, 2, 6, 8, 13, 13, 13, 15, 16, 15, 12, 10, 14, 12, 12, 15, 11, 10, 10],
                    'Jueves':   [7, 3, 1, 1, 1, 1, 2, 7, 9, 14, 15, 15, 16, 17, 16, 13, 11, 15, 13, 13, 16, 12, 11, 11],
                    'Viernes':  [8, 3, 0, 1, 0, 1, 2, 8, 10, 16, 17, 17, 18, 19, 18, 15, 13, 17, 15, 14, 18, 13, 12, 12],
                    'Sábado':   [5, 2, 1, 1, 1, 0, 1, 6, 8, 13, 13, 14, 15, 15, 15, 11, 10, 13, 11, 12, 14, 9, 9, 8],
                    'Domingo':  [2, 2, 0, 0, 1, 1, 0, 3, 5, 6, 5, 5, 6, 7, 6, 4, 3, 5, 5, 5, 5, 3, 4, 4]
                },
                after: {
                    // Total: 2,490 órdenes distribuidas proporcionalmente
                    'Lunes':    [7, 5, 1, 1, 1, 1, 2, 4, 13, 12, 20, 24, 26, 24, 23, 18, 19, 16, 19, 19, 22, 18, 17, 13],
                    'Martes':   [7, 6, 1, 0, 1, 1, 3, 5, 15, 14, 23, 27, 29, 28, 26, 20, 22, 18, 21, 21, 25, 21, 20, 14],
                    'Miércoles':[7, 6, 1, 1, 1, 1, 3, 5, 16, 15, 25, 29, 31, 30, 28, 22, 24, 19, 23, 23, 27, 23, 22, 15],
                    'Jueves':   [8, 7, 1, 0, 1, 1, 3, 6, 17, 16, 27, 31, 33, 32, 30, 24, 26, 21, 25, 25, 29, 24, 23, 17],
                    'Viernes':  [9, 7, 2, 1, 1, 2, 4, 6, 19, 18, 30, 35, 37, 35, 33, 27, 29, 24, 28, 28, 33, 27, 26, 19],
                    'Sábado':   [6, 5, 1, 1, 1, 1, 2, 4, 13, 13, 21, 24, 26, 25, 24, 18, 20, 16, 19, 20, 23, 19, 18, 13],
                    'Domingo':  [3, 2, 1, 0, 1, 1, 0, 1, 7, 7, 10, 11, 13, 13, 13, 7, 8, 7, 9, 9, 12, 10, 9, 6]
                },
                conversations: {
                    // Total: 14,439 conversaciones distribuidas proporcionalmente
                    'Lunes':    [22, 15, 5, 3, 2, 2, 7, 20, 50, 62, 80, 98, 105, 95, 85, 70, 75, 65, 72, 70, 80, 62, 52, 37],
                    'Martes':   [25, 18, 6, 4, 2, 3, 8, 23, 58, 72, 93, 114, 122, 110, 98, 81, 87, 75, 83, 81, 93, 72, 60, 43],
                    'Miércoles':[28, 20, 7, 4, 3, 3, 9, 26, 65, 80, 104, 128, 137, 124, 110, 91, 98, 85, 94, 91, 104, 81, 68, 48],
                    'Jueves':   [30, 22, 7, 4, 3, 3, 10, 28, 70, 86, 112, 138, 148, 134, 119, 98, 106, 92, 102, 98, 112, 87, 73, 52],
                    'Viernes':  [33, 24, 8, 5, 3, 4, 11, 31, 77, 95, 123, 152, 163, 147, 131, 108, 117, 101, 112, 108, 123, 96, 80, 57],
                    'Sábado':   [20, 14, 5, 3, 2, 2, 6, 18, 45, 55, 72, 89, 95, 86, 76, 63, 68, 59, 65, 63, 72, 56, 47, 33],
                    'Domingo':  [10, 7, 2, 1, 1, 1, 3, 9, 22, 27, 36, 44, 47, 43, 38, 31, 34, 29, 32, 31, 36, 28, 23, 17]
                }
            }
        };

        // Función para obtener color basado en intensidad (0-1) - Esquema azul → rojo
        function getHeatColor(intensity) {
            // Esquema de colores: azul oscuro (sin actividad) → rojo intenso (alta actividad)
            const colors = [
                [30, 58, 138],   // azul oscuro (0%)
                [59, 130, 246],  // azul medio (25%)
                [251, 191, 36],  // amarillo/naranja (50%)
                [249, 115, 22],  // naranja (75%)
                [220, 38, 38]    // rojo intenso (100%)
            ];

            if (intensity === 0) {
                return `rgb(30, 58, 138)`; // azul oscuro para cero
            }

            // Interpolación entre colores
            const scaledIntensity = intensity * (colors.length - 1);
            const lowerIndex = Math.floor(scaledIntensity);
            const upperIndex = Math.min(lowerIndex + 1, colors.length - 1);
            const fraction = scaledIntensity - lowerIndex;

            const lowerColor = colors[lowerIndex];
            const upperColor = colors[upperIndex];

            const r = Math.round(lowerColor[0] + (upperColor[0] - lowerColor[0]) * fraction);
            const g = Math.round(lowerColor[1] + (upperColor[1] - lowerColor[1]) * fraction);
            const b = Math.round(lowerColor[2] + (upperColor[2] - lowerColor[2]) * fraction);

            return `rgb(${r}, ${g}, ${b})`;
        }

        // Detectar si es móvil
        function isMobile() {
            return window.innerWidth <= 768;
        }

        // Crear gráfico lineal de evolución temporal
        function createTimelineChart() {
            const ctx = document.getElementById('timelineChart').getContext('2d');
            const mobile = isMobile();

            new Chart(ctx, {
                data: {
                    labels: DATA.monthly.labels,
                    datasets: [
                        {
                            type: 'bar',
                            label: 'Conversaciones del Agente',
                            data: DATA.monthly.conversations,
                            backgroundColor: 'rgba(59, 130, 246, 0.7)',
                            borderColor: '#3b82f6',
                            borderWidth: 2,
                            borderRadius: 8,
                            yAxisID: 'y',
                            order: 3
                        },
                        {
                            type: 'line',
                            label: 'Cantidad de Ventas',
                            data: DATA.monthly.orders,
                            borderColor: '#8b5cf6',
                            backgroundColor: 'rgba(139, 92, 246, 0.15)',
                            borderWidth: 4,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 6,
                            pointBackgroundColor: '#8b5cf6',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            yAxisID: 'y',
                            order: 1
                        },
                        {
                            type: 'line',
                            label: 'Ingresos (Millones ARS)',
                            data: DATA.monthly.revenue.map(v => v / 1000000),
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            borderWidth: 3,
                            borderDash: [8, 4],
                            tension: 0.4,
                            fill: false,
                            pointRadius: 5,
                            pointBackgroundColor: '#10b981',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            yAxisID: 'y1',
                            order: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#8b92b0',
                                font: { size: mobile ? 10 : 12 },
                                padding: mobile ? 8 : 15,
                                boxWidth: mobile ? 30 : 40
                            },
                            position: mobile ? 'bottom' : 'top'
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: '#3b82f6',
                            borderWidth: 1,
                            padding: mobile ? 8 : 12,
                            titleFont: { size: mobile ? 11 : 13 },
                            bodyFont: { size: mobile ? 10 : 12 },
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }

                                    if (context.dataset.yAxisID === 'y1') {
                                        label += '$' + context.parsed.y.toFixed(1) + 'M';
                                    } else {
                                        label += context.parsed.y.toLocaleString('es-AR');
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            position: 'left',
                            title: {
                                display: !mobile,
                                text: 'Conversaciones / Ventas',
                                color: '#8b92b0',
                                font: { size: 13, weight: 'bold' }
                            },
                            grid: {
                                color: 'rgba(139, 146, 176, 0.1)'
                            },
                            ticks: {
                                color: '#8b92b0',
                                font: { size: mobile ? 9 : 11 },
                                callback: value => mobile ? (value >= 1000 ? (value/1000).toFixed(0) + 'k' : value) : value.toLocaleString('es-AR')
                            }
                        },
                        y1: {
                            beginAtZero: true,
                            position: 'right',
                            title: {
                                display: !mobile,
                                text: 'Ingresos (Millones ARS)',
                                color: '#10b981',
                                font: { size: 13, weight: 'bold' }
                            },
                            grid: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                color: '#10b981',
                                font: { size: mobile ? 9 : 11 },
                                callback: value => '$' + value.toFixed(0) + 'M'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(139, 146, 176, 0.1)'
                            },
                            ticks: {
                                color: '#8b92b0',
                                font: { size: mobile ? 9 : 11 },
                                maxRotation: mobile ? 45 : 0,
                                minRotation: mobile ? 45 : 0
                            }
                        }
                    }
                }
            });
        }

        // Crear gráfico de comparación de crecimiento orgánico vs real
        function createGrowthComparisonChart() {
            const ctx = document.getElementById('growthComparisonChart').getContext('2d');
            const mobile = isMobile();

            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: DATA.monthly.labels,
                    datasets: [
                        {
                            label: 'Proyección Orgánica (sin agente)',
                            data: DATA.monthly.revenueProjected.map(v => v / 1000000),
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            borderDash: [10, 5],
                            tension: 0.4,
                            fill: false,
                            pointRadius: 4,
                            pointBackgroundColor: '#3b82f6',
                            order: 2
                        },
                        {
                            label: 'Crecimiento Real (con agente)',
                            data: DATA.monthly.revenueActual.map(v => v / 1000000),
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.8)',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: '-1',
                            pointRadius: 5,
                            pointBackgroundColor: '#10b981',
                            order: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#8b92b0',
                                font: { size: mobile ? 10 : 12 },
                                padding: mobile ? 8 : 15,
                                boxWidth: mobile ? 30 : 40
                            },
                            position: mobile ? 'bottom' : 'top'
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: '#3b82f6',
                            borderWidth: 1,
                            padding: mobile ? 8 : 12,
                            titleFont: { size: mobile ? 11 : 13 },
                            bodyFont: { size: mobile ? 10 : 12 },
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += '$' + context.parsed.y.toFixed(1) + 'M';

                                    // Mostrar ganancia incremental
                                    if (context.dataIndex >= 6) { // Desde junio
                                        const real = DATA.monthly.revenueActual[context.dataIndex] / 1000000;
                                        const projected = DATA.monthly.revenueProjected[context.dataIndex] / 1000000;
                                        const gain = real - projected;
                                        if (gain > 0) {
                                            label += '\n💰 Ganancia: $' + gain.toFixed(1) + 'M';
                                        }
                                    }
                                    return label;
                                }
                            }
                        },
                        annotation: {
                            annotations: {
                                agentStart: {
                                    type: 'line',
                                    xMin: 5.5,
                                    xMax: 5.5,
                                    borderColor: '#f59e0b',
                                    borderWidth: 2,
                                    borderDash: [5, 5],
                                    label: {
                                        display: true,
                                        content: '🚀 Inicio del Agente',
                                        position: 'start',
                                        backgroundColor: '#f59e0b',
                                        color: '#fff',
                                        font: {
                                            size: 11,
                                            weight: 'bold'
                                        }
                                    }
                                },
                                gainLabel1: {
                                    type: 'label',
                                    xValue: 6,
                                    yValue: 57,
                                    content: ['💵 GANANCIA', 'INCREMENTAL'],
                                    backgroundColor: 'rgba(16, 185, 129, 0.9)',
                                    color: '#fff',
                                    font: {
                                        size: 14,
                                        weight: 'bold'
                                    },
                                    padding: 8,
                                    borderRadius: 6
                                },
                                gainLabel2: {
                                    type: 'label',
                                    xValue: 7,
                                    yValue: 99,
                                    content: ['💰 $98.5M', 'Del Agente'],
                                    backgroundColor: 'rgba(34, 197, 94, 0.95)',
                                    color: '#fff',
                                    font: {
                                        size: 13,
                                        weight: 'bold'
                                    },
                                    padding: 8,
                                    borderRadius: 6
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: !mobile,
                                text: 'Ingresos (Millones ARS)',
                                color: '#8b92b0'
                            },
                            grid: {
                                color: 'rgba(139, 146, 176, 0.1)'
                            },
                            ticks: {
                                color: '#8b92b0',
                                font: { size: mobile ? 9 : 11 },
                                callback: value => `$${value.toFixed(0)}M`
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(139, 146, 176, 0.1)'
                            },
                            ticks: {
                                color: '#8b92b0',
                                font: { size: mobile ? 9 : 11 },
                                maxRotation: mobile ? 45 : 0,
                                minRotation: mobile ? 45 : 0
                            }
                        }
                    }
                }
            });
        }

        // Crear gráfico de distribución horaria (conversaciones vs ventas 24h)
        function createHourlyDistributionChart() {
            const ctx = document.getElementById('hourlyDistributionChart').getContext('2d');
            const mobile = isMobile();
            const hours = Array.from({ length: 24 }, (_, i) => `${i.toString().padStart(2, '0')}h`);

            // Calcular totales por hora desde los datos semanales
            const days = ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo'];

            const salesBeforeByHour = Array(24).fill(0);
            const salesAfterByHour = Array(24).fill(0);
            const convsByHour = Array(24).fill(0);

            // Sumar ventas antes, después y conversaciones por hora
            days.forEach(day => {
                DATA.weeklyHeatmap.before[day].forEach((value, hour) => {
                    salesBeforeByHour[hour] += value;
                });
                DATA.weeklyHeatmap.after[day].forEach((value, hour) => {
                    salesAfterByHour[hour] += value;
                });
                DATA.weeklyHeatmap.conversations[day].forEach((value, hour) => {
                    convsByHour[hour] += value;
                });
            });

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: hours,
                    datasets: [
                        {
                            label: 'Conversaciones',
                            data: convsByHour,
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: true,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Ventas ANTES del Agente',
                            data: salesBeforeByHour,
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.05)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            tension: 0.4,
                            fill: false,
                            yAxisID: 'y1'
                        },
                        {
                            label: 'Ventas DESPUÉS del Agente',
                            data: salesAfterByHour,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: true,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#8b92b0',
                                font: { size: mobile ? 9 : 12 },
                                padding: mobile ? 6 : 15,
                                boxWidth: mobile ? 25 : 40
                            },
                            position: mobile ? 'bottom' : 'top'
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: '#3b82f6',
                            borderWidth: 1,
                            padding: mobile ? 6 : 12,
                            titleFont: { size: mobile ? 10 : 13 },
                            bodyFont: { size: mobile ? 9 : 12 }
                        },
                        annotation: {
                            annotations: {
                                workHours: {
                                    type: 'box',
                                    xMin: 9,
                                    xMax: 18,
                                    backgroundColor: 'rgba(16, 185, 129, 0.08)',
                                    borderColor: 'rgba(16, 185, 129, 0.3)',
                                    borderWidth: 1,
                                    label: {
                                        display: true,
                                        content: 'Horario Laboral (9h-18h)',
                                        position: 'start',
                                        color: '#8b92b0',
                                        font: {
                                            size: 11
                                        }
                                    }
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            position: 'left',
                            title: {
                                display: !mobile,
                                text: 'Conversaciones',
                                color: '#8b92b0'
                            },
                            grid: {
                                color: 'rgba(139, 146, 176, 0.1)'
                            },
                            ticks: {
                                color: '#8b92b0',
                                font: { size: mobile ? 8 : 11 }
                            }
                        },
                        y1: {
                            beginAtZero: true,
                            position: 'right',
                            title: {
                                display: !mobile,
                                text: 'Ventas',
                                color: '#8b92b0'
                            },
                            grid: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                color: '#8b92b0',
                                font: { size: mobile ? 8 : 11 }
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(139, 146, 176, 0.1)'
                            },
                            ticks: {
                                color: '#8b92b0',
                                font: { size: mobile ? 7 : 10 },
                                maxRotation: mobile ? 90 : 0,
                                minRotation: mobile ? 90 : 0
                            }
                        }
                    }
                }
            });
        }

        // Crear mapa de calor con días de la semana (vertical) vs horas (horizontal)
        function createWeeklyHeatmap(containerId, data, label) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            const days = ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo'];
            const hours = Array.from({ length: 24 }, (_, i) => i);
            const mobile = isMobile();

            // Encontrar el máximo valor para normalizar
            const allValues = days.flatMap(day => data[day]);
            const maxValue = Math.max(...allValues);

            // Crear contenedor con scroll horizontal en móviles
            const wrapper = document.createElement('div');
            wrapper.style.overflowX = mobile ? 'auto' : 'visible';
            wrapper.style.webkitOverflowScrolling = 'touch';
            wrapper.style.marginBottom = '1rem';

            // Crear tabla de mapa de calor
            const table = document.createElement('table');
            table.style.width = mobile ? 'max-content' : '100%';
            table.style.borderCollapse = 'collapse';

            // Crear fila de encabezado con las horas
            const headerRow = document.createElement('tr');
            const emptyCell = document.createElement('th');
            emptyCell.style.padding = mobile ? '6px' : '8px';
            emptyCell.style.textAlign = 'right';
            emptyCell.style.color = 'var(--text-muted)';
            emptyCell.style.fontSize = mobile ? '0.7rem' : '0.85rem';
            emptyCell.style.width = mobile ? '70px' : '100px';
            emptyCell.style.minWidth = mobile ? '70px' : '100px';
            headerRow.appendChild(emptyCell);

            hours.forEach(hour => {
                const th = document.createElement('th');
                th.textContent = mobile && hour % 2 !== 0 ? '' : `${hour}h`;
                th.style.padding = mobile ? '3px 1px' : '4px 2px';
                th.style.textAlign = 'center';
                th.style.color = 'var(--text-muted)';
                th.style.fontSize = mobile ? '0.6rem' : '0.7rem';
                th.style.fontWeight = '400';
                th.style.minWidth = mobile ? '20px' : 'auto';
                headerRow.appendChild(th);
            });
            table.appendChild(headerRow);

            // Crear filas para cada día
            days.forEach(day => {
                const row = document.createElement('tr');

                // Celda de etiqueta del día
                const dayCell = document.createElement('td');
                dayCell.textContent = mobile ? day.substring(0, 3) : day;
                dayCell.style.padding = mobile ? '6px 8px' : '8px 12px';
                dayCell.style.textAlign = 'right';
                dayCell.style.color = 'var(--text-muted)';
                dayCell.style.fontSize = mobile ? '0.7rem' : '0.875rem';
                dayCell.style.fontWeight = '500';
                dayCell.style.borderRight = '1px solid var(--border)';
                dayCell.style.whiteSpace = 'nowrap';
                row.appendChild(dayCell);

                // Celdas de calor para cada hora
                data[day].forEach((value, hour) => {
                    const cell = document.createElement('td');
                    const intensity = value / maxValue;

                    // Usar el nuevo esquema de colores azul → rojo
                    const bgColor = getHeatColor(intensity);

                    cell.style.backgroundColor = bgColor;
                    cell.style.padding = mobile ? '10px 3px' : '12px 4px';
                    cell.style.textAlign = 'center';
                    cell.style.fontSize = mobile ? '0' : '0.75rem';
                    cell.style.fontWeight = '600';
                    cell.style.color = intensity > 0.5 ? '#fff' : 'var(--text-muted)';
                    cell.style.cursor = 'pointer';
                    cell.style.transition = 'all 0.2s ease';
                    cell.style.position = 'relative';
                    cell.style.minWidth = mobile ? '20px' : 'auto';
                    cell.style.width = mobile ? '20px' : 'auto';
                    cell.textContent = value > 0 && !mobile ? value : '';

                    // Tooltip
                    cell.title = `${day} - ${hour}:00h: ${value} ${label}`;

                    // Touch and hover effects
                    if (mobile) {
                        // Mejor interacción táctil en móviles
                        cell.addEventListener('touchstart', (e) => {
                            e.preventDefault();
                            cell.style.transform = 'scale(1.2)';
                            cell.style.zIndex = '10';
                            cell.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.5)';

                            // Crear tooltip personalizado para móvil
                            const tooltip = document.createElement('div');
                            tooltip.textContent = `${value} ${label}`;
                            tooltip.style.position = 'fixed';
                            tooltip.style.background = 'rgba(0, 0, 0, 0.9)';
                            tooltip.style.color = 'white';
                            tooltip.style.padding = '8px 12px';
                            tooltip.style.borderRadius = '6px';
                            tooltip.style.fontSize = '0.85rem';
                            tooltip.style.zIndex = '1000';
                            tooltip.style.pointerEvents = 'none';

                            const rect = cell.getBoundingClientRect();
                            tooltip.style.left = `${rect.left + rect.width / 2}px`;
                            tooltip.style.top = `${rect.top - 40}px`;
                            tooltip.style.transform = 'translateX(-50%)';
                            tooltip.id = 'mobile-tooltip';

                            document.body.appendChild(tooltip);
                        });

                        cell.addEventListener('touchend', () => {
                            cell.style.transform = 'scale(1)';
                            cell.style.zIndex = '1';
                            cell.style.boxShadow = 'none';

                            const tooltip = document.getElementById('mobile-tooltip');
                            if (tooltip) tooltip.remove();
                        });
                    } else {
                        // Hover tradicional en desktop
                        cell.addEventListener('mouseenter', () => {
                            cell.style.transform = 'scale(1.15)';
                            cell.style.zIndex = '10';
                            cell.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.4)';
                        });

                        cell.addEventListener('mouseleave', () => {
                            cell.style.transform = 'scale(1)';
                            cell.style.zIndex = '1';
                            cell.style.boxShadow = 'none';
                        });
                    }

                    row.appendChild(cell);
                });

                table.appendChild(row);
            });

            wrapper.appendChild(table);
            container.appendChild(wrapper);

            // Agregar indicador de scroll en móviles
            if (mobile) {
                const scrollHint = document.createElement('div');
                scrollHint.textContent = '← Desliza para ver todas las horas →';
                scrollHint.style.textAlign = 'center';
                scrollHint.style.color = 'var(--text-muted)';
                scrollHint.style.fontSize = '0.75rem';
                scrollHint.style.marginTop = '0.5rem';
                scrollHint.style.fontStyle = 'italic';
                container.appendChild(scrollHint);
            }
        }

        // Calcular y actualizar ROI
        function calculateROI() {
            const inversion = 5000000; // $5,000,000 ARS

            // Ingresos reales desde junio (con agente): Jun, Jul
            const ingresosRealesConAgente = 74218305 + 149461558; // = 223,679,863

            // Ingresos proyectados sin agente (crecimiento orgánico): Jun, Jul
            const ingresosProyectadosSinAgente = 40739506 + 50924383; // = 91,663,889

            // Retorno incremental atribuible al agente
            const ingresosIncrementales = ingresosRealesConAgente - ingresosProyectadosSinAgente;

            const beneficioNeto = ingresosIncrementales - inversion;
            const roi = (ingresosIncrementales / inversion) * 100;
            const multiplicador = ingresosIncrementales / inversion;

            // Formatear números
            const formatter = new Intl.NumberFormat('es-AR', {
                style: 'currency',
                currency: 'ARS',
                maximumFractionDigits: 0
            });

            const formatterDecimal = new Intl.NumberFormat('es-AR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });

            // Actualizar elementos
            document.getElementById('roiIngresosAdicionales').textContent =
                formatter.format(ingresosIncrementales).replace('ARS', '').trim();
            document.getElementById('roiPercentage').textContent =
                formatterDecimal.format(roi) + '%';
            document.getElementById('roiBeneficioNeto').textContent =
                formatter.format(beneficioNeto).replace('ARS', '').trim();

            document.getElementById('roiIngresosAdicionalesText').textContent =
                formatter.format(ingresosIncrementales);
            document.getElementById('roiPercentageText').textContent =
                formatterDecimal.format(roi) + '%';
            document.getElementById('roiMultiplier').textContent =
                formatter.format(multiplicador);
        }

        // Inicializar dashboard con optimización de rendimiento
        function init() {
            // Renderizar elementos críticos primero
            calculateROI();

            // En móviles, cargar gráficos de forma progresiva
            if (isMobile()) {
                // Cargar gráficos con pequeños delays para mejor experiencia
                requestAnimationFrame(() => {
                    createTimelineChart();

                    setTimeout(() => {
                        createGrowthComparisonChart();
                    }, 100);

                    setTimeout(() => {
                        createHourlyDistributionChart();
                    }, 200);

                    setTimeout(() => {
                        createWeeklyHeatmap('heatmapAfterWeek', DATA.weeklyHeatmap.after, 'ventas');
                    }, 300);

                    setTimeout(() => {
                        createWeeklyHeatmap('heatmapConversations', DATA.weeklyHeatmap.conversations, 'conversaciones');
                    }, 400);
                });
            } else {
                // En desktop, cargar todo a la vez
                createTimelineChart();
                createGrowthComparisonChart();
                createHourlyDistributionChart();
                createWeeklyHeatmap('heatmapAfterWeek', DATA.weeklyHeatmap.after, 'ventas');
                createWeeklyHeatmap('heatmapConversations', DATA.weeklyHeatmap.conversations, 'conversaciones');
            }
        }

        // Recargar gráficos cuando cambia la orientación en móviles
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                if (isMobile()) {
                    // Re-inicializar solo si cambia significativamente el tamaño
                    location.reload();
                }
            }, 500);
        });

        // Ejecutar cuando el DOM esté listo
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>
